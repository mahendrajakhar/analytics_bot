[
  {
    "timestamp": "2025-02-18T09:47:35.982539",
    "user_id": "U07867XKY22",
    "user_question": "average listening minutes of active users in last two days on day to day basis",
    "sql_query": "SELECT \n    DATE(date_tz) AS listening_date,\n    AVG(mins_listened) AS average_minutes_listened\nFROM \n    analytics.super.raw_listening_impression_combined_show_level\nWHERE \n    final_profile_id IN (\n        SELECT final_profile_id \n        FROM analytics.super.premium_user_all_orders \n        WHERE subscription_status = 'active'\n    )\n    AND date_tz >= CURRENT_DATE - INTERVAL '2 days'\n    AND date_tz < CURRENT_DATE\nGROUP BY \n    listening_date\nORDER BY \n    listening_date;"
  },
  {
    "timestamp": "2025-03-03T08:17:11.938039",
    "user_id": "U07867XKY22",
    "user_name": "mjakhar1212",
    "question": "provide me data of subscription renewals for this week",
    "sql_query": "SELECT \n    DATE(order_tz) AS renewal_date,               -- Extract the date from the order timestamp\n    final_profile_id,                             -- User ID\n    subscription_id,                              -- Subscription ID\n    plan_id,                                      -- ID of the subscription plan\n    revenue,                                      -- Revenue generated from the renewal\n    payment_gateway,                              -- Payment gateway used for the renewal\n    subscription_status,                           -- Status of the subscription\n    created_on_utc                                -- Creation date of the renewal\nFROM \n    analytics.super.premium_user_all_orders       -- Data source for premium user orders\nWHERE \n    order_tz >= CURRENT_DATE - INTERVAL '7 days'  -- Filter for the last 7 days\n    AND order_tz < CURRENT_DATE                    -- Exclude today\n    AND renew_sub = 1                              -- Only include renewed subscriptions\nORDER BY \n    renewal_date;                                  -- Order results by renewal date",
    "response": "```\nrenewal_date | final_profile_id | subscription_id | plan_id | revenue | payment_gateway | subscription_status | created_on_utc     \n-----------------------------------------------------------------------------------------------------------------------------------\n2025-02-24   | 2,367,945        | 30,916,257.0    | 172     | 99.0    | juspay          | active              | 2025-02-24 04:32:42\n2025-02-24   | 2,412,919        | 9,913,766.0     | 172     | 99.0    | phonepe         | active              | 2025-02-24 04:35:33\n2025-02-24   | 9,802,110        | 12,263,500.0    | 172     | 99.0    | phonepe         | active              | 2025-02-24 04:34:18\n2025-02-24   | 14,143,555       | 21,869,627.0    | 172     | 99.0    | juspay          | active              | 2025-02-24 04:36:43\n2025-02-24   | 14,389,001       | 12,860,290.0    | 172     | 99.0    | razorpay_v2     | active              | 2025-02-24 05:34:25\n```\n(Showing 5 of 184766 rows)",
    "ai_response": "SQL query:\n```sql\nSELECT \n    DATE(order_tz) AS renewal_date,               -- Extract the date from the order timestamp\n    final_profile_id,                             -- User ID\n    subscription_id,                              -- Subscription ID\n    plan_id,                                      -- ID of the subscription plan\n    revenue,                                      -- Revenue generated from the renewal\n    payment_gateway,                              -- Payment gateway used for the renewal\n    subscription_status,                           -- Status of the subscription\n    created_on_utc                                -- Creation date of the renewal\nFROM \n    analytics.super.premium_user_all_orders       -- Data source for premium user orders\nWHERE \n    order_tz >= CURRENT_DATE - INTERVAL '7 days'  -- Filter for the last 7 days\n    AND order_tz < CURRENT_DATE                    -- Exclude today\n    AND renew_sub = 1                              -- Only include renewed subscriptions\nORDER BY \n    renewal_date;                                  -- Order results by renewal date\n```"
  }
]