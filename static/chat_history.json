{
    "123": [
        {
            "question": "Generate a SQL query for this question: give me total number of netflix movies for each country.",
            "sql_query": "SELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;",
            "response": "```sql\nSELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;\n```\nSQL Result: \nResults:\ncountry              | total_movies | \n--------------------------------------\nUnited States        | 2395         | \nBrazil               | 60           | \nIndia                | 976          | \nGermany              | 79           | \nPakistan             | 71           | \nNot Given            | 257          | \nChina                | 59           | \nSouth Africa         | 35           | \nJapan                | 87           | \nNigeria              | 96           | \nSpain                | 129          | \nFrance               | 148          | \nUnited Kingdom       | 387          | \nPhilippines          | 80           | \nAustralia            | 61           | \nArgentina            | 56           | \nCanada               | 187          | \nHong Kong            | 76           | \nItaly                | 47           | \nNew Zealand          | 15           | \nEgypt                | 109          | \nColombia             | 17           | \nMexico               | 90           | \nBelgium              | 9            | \nSwitzerland          | 7            | \nBulgaria             | 5            | \nPoland               | 22           | \nSouth Korea          | 49           | \nSaudi Arabia         | 7            | \nThailand             | 42           | \nIndonesia            | 84           | \nKuwait               | 5            | \nMalaysia             | 16           | \nVietnam              | 7            | \nLebanon              | 18           | \nRomania              | 10           | \nSyria                | 2            | \nUnited Arab Emirates | 20           | \nSweden               | 11           | \nMauritius            | 1            | \nAustria              | 8            | \nTurkey               | 82           | \nCzech Republic       | 5            | \nCameroon             | 1            | \nNetherlands          | 23           | \nIreland              | 22           | \nRussia               | 5            | \nTaiwan               | 15           | \nKenya                | 4            | \nChile                | 18           | \nUruguay              | 8            | \nBangladesh           | 3            | \nPortugal             | 4            | \nHungary              | 5            | \nNorway               | 12           | \nSingapore            | 10           | \nIceland              | 3            | \nSerbia               | 3            | \nNamibia              | 1            | \nPeru                 | 6            | \nMozambique           | 1            | \nGhana                | 4            | \nZimbabwe             | 1            | \nIsrael               | 12           | \nFinland              | 3            | \nDenmark              | 19           | \nParaguay             | 1            | \nCambodia             | 2            | \nGeorgia              | 2            | \nSoviet Union         | 1            | \nGreece               | 1            | \nWest Germany         | 1            | \nIran                 | 1            | \nVenezuela            | 2            | \nSlovenia             | 1            | \nGuatemala            | 1            | \nJamaica              | 1            | \nSomalia              | 1            | \nCroatia              | 1            | ",
            "graph_code": ""
        },
        {
            "question": "Generate a SQL query for this question: give me total number of netflix movies for each country.",
            "sql_query": "SELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;",
            "response": "```sql\nSELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;\n```\nSQL Result: \nResults:\ncountry              | total_movies | \n--------------------------------------\nUnited States        | 2395         | \nBrazil               | 60           | \nIndia                | 976          | \nGermany              | 79           | \nPakistan             | 71           | \nNot Given            | 257          | \nChina                | 59           | \nSouth Africa         | 35           | \nJapan                | 87           | \nNigeria              | 96           | \nSpain                | 129          | \nFrance               | 148          | \nUnited Kingdom       | 387          | \nPhilippines          | 80           | \nAustralia            | 61           | \nArgentina            | 56           | \nCanada               | 187          | \nHong Kong            | 76           | \nItaly                | 47           | \nNew Zealand          | 15           | \nEgypt                | 109          | \nColombia             | 17           | \nMexico               | 90           | \nBelgium              | 9            | \nSwitzerland          | 7            | \nBulgaria             | 5            | \nPoland               | 22           | \nSouth Korea          | 49           | \nSaudi Arabia         | 7            | \nThailand             | 42           | \nIndonesia            | 84           | \nKuwait               | 5            | \nMalaysia             | 16           | \nVietnam              | 7            | \nLebanon              | 18           | \nRomania              | 10           | \nSyria                | 2            | \nUnited Arab Emirates | 20           | \nSweden               | 11           | \nMauritius            | 1            | \nAustria              | 8            | \nTurkey               | 82           | \nCzech Republic       | 5            | \nCameroon             | 1            | \nNetherlands          | 23           | \nIreland              | 22           | \nRussia               | 5            | \nTaiwan               | 15           | \nKenya                | 4            | \nChile                | 18           | \nUruguay              | 8            | \nBangladesh           | 3            | \nPortugal             | 4            | \nHungary              | 5            | \nNorway               | 12           | \nSingapore            | 10           | \nIceland              | 3            | \nSerbia               | 3            | \nNamibia              | 1            | \nPeru                 | 6            | \nMozambique           | 1            | \nGhana                | 4            | \nZimbabwe             | 1            | \nIsrael               | 12           | \nFinland              | 3            | \nDenmark              | 19           | \nParaguay             | 1            | \nCambodia             | 2            | \nGeorgia              | 2            | \nSoviet Union         | 1            | \nGreece               | 1            | \nWest Germany         | 1            | \nIran                 | 1            | \nVenezuela            | 2            | \nSlovenia             | 1            | \nGuatemala            | 1            | \nJamaica              | 1            | \nSomalia              | 1            | \nCroatia              | 1            | ",
            "graph_code": ""
        },
        {
            "question": "Generate a SQL query for this question: give me total number of netflix movies for each country.",
            "sql_query": "SELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;",
            "response": "```sql\nSELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;\n```\nSQL Result: \nResults:\ncountry              | total_movies | \n--------------------------------------\nUnited States        | 2395         | \nBrazil               | 60           | \nIndia                | 976          | \nGermany              | 79           | \nPakistan             | 71           | \nNot Given            | 257          | \nChina                | 59           | \nSouth Africa         | 35           | \nJapan                | 87           | \nNigeria              | 96           | \nSpain                | 129          | \nFrance               | 148          | \nUnited Kingdom       | 387          | \nPhilippines          | 80           | \nAustralia            | 61           | \nArgentina            | 56           | \nCanada               | 187          | \nHong Kong            | 76           | \nItaly                | 47           | \nNew Zealand          | 15           | \nEgypt                | 109          | \nColombia             | 17           | \nMexico               | 90           | \nBelgium              | 9            | \nSwitzerland          | 7            | \nBulgaria             | 5            | \nPoland               | 22           | \nSouth Korea          | 49           | \nSaudi Arabia         | 7            | \nThailand             | 42           | \nIndonesia            | 84           | \nKuwait               | 5            | \nMalaysia             | 16           | \nVietnam              | 7            | \nLebanon              | 18           | \nRomania              | 10           | \nSyria                | 2            | \nUnited Arab Emirates | 20           | \nSweden               | 11           | \nMauritius            | 1            | \nAustria              | 8            | \nTurkey               | 82           | \nCzech Republic       | 5            | \nCameroon             | 1            | \nNetherlands          | 23           | \nIreland              | 22           | \nRussia               | 5            | \nTaiwan               | 15           | \nKenya                | 4            | \nChile                | 18           | \nUruguay              | 8            | \nBangladesh           | 3            | \nPortugal             | 4            | \nHungary              | 5            | \nNorway               | 12           | \nSingapore            | 10           | \nIceland              | 3            | \nSerbia               | 3            | \nNamibia              | 1            | \nPeru                 | 6            | \nMozambique           | 1            | \nGhana                | 4            | \nZimbabwe             | 1            | \nIsrael               | 12           | \nFinland              | 3            | \nDenmark              | 19           | \nParaguay             | 1            | \nCambodia             | 2            | \nGeorgia              | 2            | \nSoviet Union         | 1            | \nGreece               | 1            | \nWest Germany         | 1            | \nIran                 | 1            | \nVenezuela            | 2            | \nSlovenia             | 1            | \nGuatemala            | 1            | \nJamaica              | 1            | \nSomalia              | 1            | \nCroatia              | 1            | ",
            "graph_code": ""
        },
        {
            "question": "Generate a SQL query for this question: give me total number of netflix movies for each country.",
            "sql_query": "SELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;",
            "response": "```sql\nSELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;\n```\nSQL Result: \nResults:\ncountry              | total_movies | \n--------------------------------------\nUnited States        | 2395         | \nBrazil               | 60           | \nIndia                | 976          | \nGermany              | 79           | \nPakistan             | 71           | \nNot Given            | 257          | \nChina                | 59           | \nSouth Africa         | 35           | \nJapan                | 87           | \nNigeria              | 96           | \nSpain                | 129          | \nFrance               | 148          | \nUnited Kingdom       | 387          | \nPhilippines          | 80           | \nAustralia            | 61           | \nArgentina            | 56           | \nCanada               | 187          | \nHong Kong            | 76           | \nItaly                | 47           | \nNew Zealand          | 15           | \nEgypt                | 109          | \nColombia             | 17           | \nMexico               | 90           | \nBelgium              | 9            | \nSwitzerland          | 7            | \nBulgaria             | 5            | \nPoland               | 22           | \nSouth Korea          | 49           | \nSaudi Arabia         | 7            | \nThailand             | 42           | \nIndonesia            | 84           | \nKuwait               | 5            | \nMalaysia             | 16           | \nVietnam              | 7            | \nLebanon              | 18           | \nRomania              | 10           | \nSyria                | 2            | \nUnited Arab Emirates | 20           | \nSweden               | 11           | \nMauritius            | 1            | \nAustria              | 8            | \nTurkey               | 82           | \nCzech Republic       | 5            | \nCameroon             | 1            | \nNetherlands          | 23           | \nIreland              | 22           | \nRussia               | 5            | \nTaiwan               | 15           | \nKenya                | 4            | \nChile                | 18           | \nUruguay              | 8            | \nBangladesh           | 3            | \nPortugal             | 4            | \nHungary              | 5            | \nNorway               | 12           | \nSingapore            | 10           | \nIceland              | 3            | \nSerbia               | 3            | \nNamibia              | 1            | \nPeru                 | 6            | \nMozambique           | 1            | \nGhana                | 4            | \nZimbabwe             | 1            | \nIsrael               | 12           | \nFinland              | 3            | \nDenmark              | 19           | \nParaguay             | 1            | \nCambodia             | 2            | \nGeorgia              | 2            | \nSoviet Union         | 1            | \nGreece               | 1            | \nWest Germany         | 1            | \nIran                 | 1            | \nVenezuela            | 2            | \nSlovenia             | 1            | \nGuatemala            | 1            | \nJamaica              | 1            | \nSomalia              | 1            | \nCroatia              | 1            | ",
            "graph_code": ""
        },
        {
            "question": "Generate a SQL query for this question: give me total number of netflix movies for each country.",
            "sql_query": "SELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;",
            "response": "```sql\nSELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;\n```\nSQL Result: \nResults:\ncountry              | total_movies | \n--------------------------------------\nUnited States        | 2395         | \nBrazil               | 60           | \nIndia                | 976          | \nGermany              | 79           | \nPakistan             | 71           | \nNot Given            | 257          | \nChina                | 59           | \nSouth Africa         | 35           | \nJapan                | 87           | \nNigeria              | 96           | \nSpain                | 129          | \nFrance               | 148          | \nUnited Kingdom       | 387          | \nPhilippines          | 80           | \nAustralia            | 61           | \nArgentina            | 56           | \nCanada               | 187          | \nHong Kong            | 76           | \nItaly                | 47           | \nNew Zealand          | 15           | \nEgypt                | 109          | \nColombia             | 17           | \nMexico               | 90           | \nBelgium              | 9            | \nSwitzerland          | 7            | \nBulgaria             | 5            | \nPoland               | 22           | \nSouth Korea          | 49           | \nSaudi Arabia         | 7            | \nThailand             | 42           | \nIndonesia            | 84           | \nKuwait               | 5            | \nMalaysia             | 16           | \nVietnam              | 7            | \nLebanon              | 18           | \nRomania              | 10           | \nSyria                | 2            | \nUnited Arab Emirates | 20           | \nSweden               | 11           | \nMauritius            | 1            | \nAustria              | 8            | \nTurkey               | 82           | \nCzech Republic       | 5            | \nCameroon             | 1            | \nNetherlands          | 23           | \nIreland              | 22           | \nRussia               | 5            | \nTaiwan               | 15           | \nKenya                | 4            | \nChile                | 18           | \nUruguay              | 8            | \nBangladesh           | 3            | \nPortugal             | 4            | \nHungary              | 5            | \nNorway               | 12           | \nSingapore            | 10           | \nIceland              | 3            | \nSerbia               | 3            | \nNamibia              | 1            | \nPeru                 | 6            | \nMozambique           | 1            | \nGhana                | 4            | \nZimbabwe             | 1            | \nIsrael               | 12           | \nFinland              | 3            | \nDenmark              | 19           | \nParaguay             | 1            | \nCambodia             | 2            | \nGeorgia              | 2            | \nSoviet Union         | 1            | \nGreece               | 1            | \nWest Germany         | 1            | \nIran                 | 1            | \nVenezuela            | 2            | \nSlovenia             | 1            | \nGuatemala            | 1            | \nJamaica              | 1            | \nSomalia              | 1            | \nCroatia              | 1            | ",
            "graph_code": ""
        },
        {
            "question": "Generate a SQL query for this question: give me total number of netflix movies for each country.",
            "sql_query": "SELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;",
            "response": "```sql\nSELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;\n```\nSQL Result: \nResults:\ncountry              | total_movies | \n--------------------------------------\nUnited States        | 2395         | \nBrazil               | 60           | \nIndia                | 976          | \nGermany              | 79           | \nPakistan             | 71           | \nNot Given            | 257          | \nChina                | 59           | \nSouth Africa         | 35           | \nJapan                | 87           | \nNigeria              | 96           | \nSpain                | 129          | \nFrance               | 148          | \nUnited Kingdom       | 387          | \nPhilippines          | 80           | \nAustralia            | 61           | \nArgentina            | 56           | \nCanada               | 187          | \nHong Kong            | 76           | \nItaly                | 47           | \nNew Zealand          | 15           | \nEgypt                | 109          | \nColombia             | 17           | \nMexico               | 90           | \nBelgium              | 9            | \nSwitzerland          | 7            | \nBulgaria             | 5            | \nPoland               | 22           | \nSouth Korea          | 49           | \nSaudi Arabia         | 7            | \nThailand             | 42           | \nIndonesia            | 84           | \nKuwait               | 5            | \nMalaysia             | 16           | \nVietnam              | 7            | \nLebanon              | 18           | \nRomania              | 10           | \nSyria                | 2            | \nUnited Arab Emirates | 20           | \nSweden               | 11           | \nMauritius            | 1            | \nAustria              | 8            | \nTurkey               | 82           | \nCzech Republic       | 5            | \nCameroon             | 1            | \nNetherlands          | 23           | \nIreland              | 22           | \nRussia               | 5            | \nTaiwan               | 15           | \nKenya                | 4            | \nChile                | 18           | \nUruguay              | 8            | \nBangladesh           | 3            | \nPortugal             | 4            | \nHungary              | 5            | \nNorway               | 12           | \nSingapore            | 10           | \nIceland              | 3            | \nSerbia               | 3            | \nNamibia              | 1            | \nPeru                 | 6            | \nMozambique           | 1            | \nGhana                | 4            | \nZimbabwe             | 1            | \nIsrael               | 12           | \nFinland              | 3            | \nDenmark              | 19           | \nParaguay             | 1            | \nCambodia             | 2            | \nGeorgia              | 2            | \nSoviet Union         | 1            | \nGreece               | 1            | \nWest Germany         | 1            | \nIran                 | 1            | \nVenezuela            | 2            | \nSlovenia             | 1            | \nGuatemala            | 1            | \nJamaica              | 1            | \nSomalia              | 1            | \nCroatia              | 1            | ",
            "graph_code": ""
        },
        {
            "question": "Generate a SQL query for this question: give me date when maximum number of movies or tv shows where added on netflix",
            "sql_query": "SELECT date_added, COUNT(*) AS total_shows\nFROM netflix\nGROUP BY date_added\nORDER BY total_shows DESC\nLIMIT 1;",
            "response": "```sql\nSELECT date_added, COUNT(*) AS total_shows\nFROM netflix\nGROUP BY date_added\nORDER BY total_shows DESC\nLIMIT 1;\n```\nSQL Result: \nResults:\ndate_added | total_shows | \n---------------------------\n1/1/2020   | 110         | ",
            "graph_code": ""
        },
        {
            "question": "Generate a SQL query and optionally a graph for this question: give me graph of total movies added for country and only draw graph for top 10 coutry ",
            "sql_query": "SELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country\nORDER BY total_movies DESC\nLIMIT 10;",
            "response": "```sql\nSELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country\nORDER BY total_movies DESC\nLIMIT 10;\n```\n\nAfter executing the SQL query, you can use the following Python code to plot the graph:\n\n```python\nimport matplotlib.pyplot as plt\n\n# Assuming sql_result is the dictionary containing the SQL results\n# Example sql_result:\nsql_result = {\n    'country': ['United States', 'India', 'United Kingdom', 'Canada', 'Australia', 'Germany', 'France', 'Brazil', 'Japan', 'Mexico'],\n    'total_movies': [2395, 976, 387, 187, 61, 79, 148, 60, 87, 90]\n}\n\ncountries = sql_result['country']\ntotal_movies = sql_result['total_movies']\n\nplt.figure(figsize=(10, 6))\nplt.barh(countries, total_movies, color='skyblue')\nplt.xlabel('Total Movies')\nplt.title('Top 10 Countries by Total Movies Added on Netflix')\nplt.gca().invert_yaxis()  # To display the highest value on top\nplt.show()\n```\nSQL Result: \nResults:\ncountry        | total_movies | \n--------------------------------\nUnited States  | 2395         | \nIndia          | 976          | \nUnited Kingdom | 387          | \nNot Given      | 257          | \nCanada         | 187          | \nFrance         | 148          | \nSpain          | 129          | \nEgypt          | 109          | \nNigeria        | 96           | \nMexico         | 90           | ",
            "graph_code": "import matplotlib.pyplot as plt\n\n# Assuming sql_result is the dictionary containing the SQL results\n# Example sql_result:\nsql_result = {\n    'country': ['United States', 'India', 'United Kingdom', 'Canada', 'Australia', 'Germany', 'France', 'Brazil', 'Japan', 'Mexico'],\n    'total_movies': [2395, 976, 387, 187, 61, 79, 148, 60, 87, 90]\n}\n\ncountries = sql_result['country']\ntotal_movies = sql_result['total_movies']\n\nplt.figure(figsize=(10, 6))\nplt.barh(countries, total_movies, color='skyblue')\nplt.xlabel('Total Movies')\nplt.title('Top 10 Countries by Total Movies Added on Netflix')\nplt.gca().invert_yaxis()  # To display the highest value on top\nplt.show()"
        },
        {
            "question": "Generate a SQL query for this question: give me total number of netflix movies for each country.",
            "sql_query": "SELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;",
            "response": "```sql\nSELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;\n```\nSQL Result: \nResults:\ncountry              | total_movies | \n--------------------------------------\nUnited States        | 2395         | \nBrazil               | 60           | \nIndia                | 976          | \nGermany              | 79           | \nPakistan             | 71           | \nNot Given            | 257          | \nChina                | 59           | \nSouth Africa         | 35           | \nJapan                | 87           | \nNigeria              | 96           | \nSpain                | 129          | \nFrance               | 148          | \nUnited Kingdom       | 387          | \nPhilippines          | 80           | \nAustralia            | 61           | \nArgentina            | 56           | \nCanada               | 187          | \nHong Kong            | 76           | \nItaly                | 47           | \nNew Zealand          | 15           | \nEgypt                | 109          | \nColombia             | 17           | \nMexico               | 90           | \nBelgium              | 9            | \nSwitzerland          | 7            | \nBulgaria             | 5            | \nPoland               | 22           | \nSouth Korea          | 49           | \nSaudi Arabia         | 7            | \nThailand             | 42           | \nIndonesia            | 84           | \nKuwait               | 5            | \nMalaysia             | 16           | \nVietnam              | 7            | \nLebanon              | 18           | \nRomania              | 10           | \nSyria                | 2            | \nUnited Arab Emirates | 20           | \nSweden               | 11           | \nMauritius            | 1            | \nAustria              | 8            | \nTurkey               | 82           | \nCzech Republic       | 5            | \nCameroon             | 1            | \nNetherlands          | 23           | \nIreland              | 22           | \nRussia               | 5            | \nTaiwan               | 15           | \nKenya                | 4            | \nChile                | 18           | \nUruguay              | 8            | \nBangladesh           | 3            | \nPortugal             | 4            | \nHungary              | 5            | \nNorway               | 12           | \nSingapore            | 10           | \nIceland              | 3            | \nSerbia               | 3            | \nNamibia              | 1            | \nPeru                 | 6            | \nMozambique           | 1            | \nGhana                | 4            | \nZimbabwe             | 1            | \nIsrael               | 12           | \nFinland              | 3            | \nDenmark              | 19           | \nParaguay             | 1            | \nCambodia             | 2            | \nGeorgia              | 2            | \nSoviet Union         | 1            | \nGreece               | 1            | \nWest Germany         | 1            | \nIran                 | 1            | \nVenezuela            | 2            | \nSlovenia             | 1            | \nGuatemala            | 1            | \nJamaica              | 1            | \nSomalia              | 1            | \nCroatia              | 1            | ",
            "graph_code": ""
        },
        {
            "question": "Generate a SQL query and optionally a graph for this question: give me total number of netflix movies for each country generate graph for 10 countries",
            "sql_query": "SELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country\nORDER BY total_movies DESC\nLIMIT 10;",
            "response": "```sql\nSELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country\nORDER BY total_movies DESC\nLIMIT 10;\n```\n\nAfter executing the SQL query, you can use the following Python code to plot the graph:\n\n```python\nimport matplotlib.pyplot as plt\n\n# Assuming sql_result is the dictionary containing the SQL results\n# Example sql_result:\nsql_result = {\n    'country': ['United States', 'India', 'United Kingdom', 'Canada', 'Australia', 'Germany', 'France', 'Brazil', 'Japan', 'Mexico'],\n    'total_movies': [2395, 976, 387, 187, 61, 79, 148, 60, 87, 90]\n}\n\ncountries = sql_result['country']\ntotal_movies = sql_result['total_movies']\n\nplt.figure(figsize=(10, 6))\nplt.barh(countries, total_movies, color='skyblue')\nplt.xlabel('Total Movies')\nplt.title('Top 10 Countries by Total Movies on Netflix')\nplt.gca().invert_yaxis()  # To display the highest value on top\nplt.show()\n```\nSQL Result: \nResults:\ncountry          | total_movies | \n-----------------------------------\nUnited States    | 2395         | \nIndia            | 976          | \nUnited Kingdom   | 387          | \nCanada           | 187          | \nAustralia        | 61           | \nGermany          | 79           | \nFrance           | 148          | \nBrazil           | 60           | \nJapan            | 87           | \nMexico           | 90           | \nSQL Result: \nResults:\ncountry        | total_movies | \n--------------------------------\nUnited States  | 2395         | \nIndia          | 976          | \nUnited Kingdom | 387          | \nNot Given      | 257          | \nCanada         | 187          | \nFrance         | 148          | \nSpain          | 129          | \nEgypt          | 109          | \nNigeria        | 96           | \nMexico         | 90           | ",
            "graph_code": "import matplotlib.pyplot as plt\n\n# Assuming sql_result is the dictionary containing the SQL results\n# Example sql_result:\nsql_result = {\n    'country': ['United States', 'India', 'United Kingdom', 'Canada', 'Australia', 'Germany', 'France', 'Brazil', 'Japan', 'Mexico'],\n    'total_movies': [2395, 976, 387, 187, 61, 79, 148, 60, 87, 90]\n}\n\ncountries = sql_result['country']\ntotal_movies = sql_result['total_movies']\n\nplt.figure(figsize=(10, 6))\nplt.barh(countries, total_movies, color='skyblue')\nplt.xlabel('Total Movies')\nplt.title('Top 10 Countries by Total Movies on Netflix')\nplt.gca().invert_yaxis()  # To display the highest value on top\nplt.show()"
        },
        {
            "question": "Generate a SQL query for this question: give me total number of netflix movies for each country.",
            "sql_query": "SELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;",
            "response": "```sql\nSELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;\n```\nSQL Result: \nResults:\ncountry              | total_movies | \n--------------------------------------\nUnited States        | 2395         | \nBrazil               | 60           | \nIndia                | 976          | \nGermany              | 79           | \nPakistan             | 71           | \nNot Given            | 257          | \nChina                | 59           | \nSouth Africa         | 35           | \nJapan                | 87           | \nNigeria              | 96           | \nSpain                | 129          | \nFrance               | 148          | \nUnited Kingdom       | 387          | \nPhilippines          | 80           | \nAustralia            | 61           | \nArgentina            | 56           | \nCanada               | 187          | \nHong Kong            | 76           | \nItaly                | 47           | \nNew Zealand          | 15           | \nEgypt                | 109          | \nColombia             | 17           | \nMexico               | 90           | \nBelgium              | 9            | \nSwitzerland          | 7            | \nBulgaria             | 5            | \nPoland               | 22           | \nSouth Korea          | 49           | \nSaudi Arabia         | 7            | \nThailand             | 42           | \nIndonesia            | 84           | \nKuwait               | 5            | \nMalaysia             | 16           | \nVietnam              | 7            | \nLebanon              | 18           | \nRomania              | 10           | \nSyria                | 2            | \nUnited Arab Emirates | 20           | \nSweden               | 11           | \nMauritius            | 1            | \nAustria              | 8            | \nTurkey               | 82           | \nCzech Republic       | 5            | \nCameroon             | 1            | \nNetherlands          | 23           | \nIreland              | 22           | \nRussia               | 5            | \nTaiwan               | 15           | \nKenya                | 4            | \nChile                | 18           | \nUruguay              | 8            | \nBangladesh           | 3            | \nPortugal             | 4            | \nHungary              | 5            | \nNorway               | 12           | \nSingapore            | 10           | \nIceland              | 3            | \nSerbia               | 3            | \nNamibia              | 1            | \nPeru                 | 6            | \nMozambique           | 1            | \nGhana                | 4            | \nZimbabwe             | 1            | \nIsrael               | 12           | \nFinland              | 3            | \nDenmark              | 19           | \nParaguay             | 1            | \nCambodia             | 2            | \nGeorgia              | 2            | \nSoviet Union         | 1            | \nGreece               | 1            | \nWest Germany         | 1            | \nIran                 | 1            | \nVenezuela            | 2            | \nSlovenia             | 1            | \nGuatemala            | 1            | \nJamaica              | 1            | \nSomalia              | 1            | \nCroatia              | 1            | ",
            "graph_code": ""
        },
        {
            "question": "Generate a SQL query and optionally a graph for this question: give me total number of netflix movies for each country. draw graph of top 10 contries in total movies",
            "sql_query": "SELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country\nORDER BY total_movies DESC\nLIMIT 10;",
            "response": "```sql\nSELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country\nORDER BY total_movies DESC\nLIMIT 10;\n```\n\nAfter executing the SQL query, you can use the following Python code to plot the graph:\n\n```python\nimport matplotlib.pyplot as plt\n\n# Assuming sql_result is the dictionary containing the SQL results\n# Example sql_result:\nsql_result = {\n    'country': ['United States', 'India', 'United Kingdom', 'Canada', 'Australia', 'Germany', 'France', 'Brazil', 'Japan', 'Mexico'],\n    'total_movies': [2395, 976, 387, 187, 61, 79, 148, 60, 87, 90]\n}\n\ncountries = sql_result['country']\ntotal_movies = sql_result['total_movies']\n\nplt.figure(figsize=(10, 6))\nplt.barh(countries, total_movies, color='skyblue')\nplt.xlabel('Total Movies')\nplt.title('Top 10 Countries by Total Movies on Netflix')\nplt.gca().invert_yaxis()  # To display the highest value on top\nplt.show()\n```\nSQL Result: \nResults:\ncountry          | total_movies | \n-----------------------------------\nUnited States    | 2395         | \nIndia            | 976          | \nUnited Kingdom   | 387          | \nCanada           | 187          | \nAustralia        | 61           | \nGermany          | 79           | \nFrance           | 148          | \nBrazil           | 60           | \nJapan            | 87           | \nMexico           | 90           | \nSQL Result: \nResults:\ncountry        | total_movies | \n--------------------------------\nUnited States  | 2395         | \nIndia          | 976          | \nUnited Kingdom | 387          | \nNot Given      | 257          | \nCanada         | 187          | \nFrance         | 148          | \nSpain          | 129          | \nEgypt          | 109          | \nNigeria        | 96           | \nMexico         | 90           | ",
            "graph_code": "import matplotlib.pyplot as plt\n\n# Assuming sql_result is the dictionary containing the SQL results\n# Example sql_result:\nsql_result = {\n    'country': ['United States', 'India', 'United Kingdom', 'Canada', 'Australia', 'Germany', 'France', 'Brazil', 'Japan', 'Mexico'],\n    'total_movies': [2395, 976, 387, 187, 61, 79, 148, 60, 87, 90]\n}\n\ncountries = sql_result['country']\ntotal_movies = sql_result['total_movies']\n\nplt.figure(figsize=(10, 6))\nplt.barh(countries, total_movies, color='skyblue')\nplt.xlabel('Total Movies')\nplt.title('Top 10 Countries by Total Movies on Netflix')\nplt.gca().invert_yaxis()  # To display the highest value on top\nplt.show()"
        },
        {
            "question": "Generate a SQL query for this question: give me total number of netflix movies for each country.",
            "sql_query": "SELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;",
            "response": "```sql\nSELECT country, COUNT(*) AS total_movies\nFROM netflix\nWHERE type = 'Movie'\nGROUP BY country;\n```\nSQL Result: \nResults:\ncountry              | total_movies | \n--------------------------------------\nUnited States        | 2395         | \nBrazil               | 60           | \nIndia                | 976          | \nGermany              | 79           | \nPakistan             | 71           | \nNot Given            | 257          | \nChina                | 59           | \nSouth Africa         | 35           | \nJapan                | 87           | \nNigeria              | 96           | \nSpain                | 129          | \nFrance               | 148          | \nUnited Kingdom       | 387          | \nPhilippines          | 80           | \nAustralia            | 61           | \nArgentina            | 56           | \nCanada               | 187          | \nHong Kong            | 76           | \nItaly                | 47           | \nNew Zealand          | 15           | \nEgypt                | 109          | \nColombia             | 17           | \nMexico               | 90           | \nBelgium              | 9            | \nSwitzerland          | 7            | \nBulgaria             | 5            | \nPoland               | 22           | \nSouth Korea          | 49           | \nSaudi Arabia         | 7            | \nThailand             | 42           | \nIndonesia            | 84           | \nKuwait               | 5            | \nMalaysia             | 16           | \nVietnam              | 7            | \nLebanon              | 18           | \nRomania              | 10           | \nSyria                | 2            | \nUnited Arab Emirates | 20           | \nSweden               | 11           | \nMauritius            | 1            | \nAustria              | 8            | \nTurkey               | 82           | \nCzech Republic       | 5            | \nCameroon             | 1            | \nNetherlands          | 23           | \nIreland              | 22           | \nRussia               | 5            | \nTaiwan               | 15           | \nKenya                | 4            | \nChile                | 18           | \nUruguay              | 8            | \nBangladesh           | 3            | \nPortugal             | 4            | \nHungary              | 5            | \nNorway               | 12           | \nSingapore            | 10           | \nIceland              | 3            | \nSerbia               | 3            | \nNamibia              | 1            | \nPeru                 | 6            | \nMozambique           | 1            | \nGhana                | 4            | \nZimbabwe             | 1            | \nIsrael               | 12           | \nFinland              | 3            | \nDenmark              | 19           | \nParaguay             | 1            | \nCambodia             | 2            | \nGeorgia              | 2            | \nSoviet Union         | 1            | \nGreece               | 1            | \nWest Germany         | 1            | \nIran                 | 1            | \nVenezuela            | 2            | \nSlovenia             | 1            | \nGuatemala            | 1            | \nJamaica              | 1            | \nSomalia              | 1            | \nCroatia              | 1            | ",
            "graph_code": "",
            "timestamp": "2025-02-05 13:14:59.727493"
        }
    ]
}